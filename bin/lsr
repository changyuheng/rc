#!/system/bin/sh
#!/usr/bin/env sh

#
# find -ls
#
. /system/bin/.gbrc > /dev/null 2>&1

while getopts "ls" OPTIONS; do
	case "$OPTIONS" in
		l)      opt="1"; l="-l";;
		s)      opt="1"; s="-s";;
	esac
done

shift $(($OPTIND-1))

# android-ls is not supported -1 -i
ls -R "$@" |
while read line; do
	case "$line" in
		*:) # pushd by ':'
			d="${line%:*}"
			dst="${d}"
			;;
		?*)
			if ls "$d" > /dev/null 2>&1; then
				dst="${d}/${line}"
				list=`ls $l $s -d "${dst}"`
			else
				dst="${line}"
				list=`ls $l $s -d "${line}"`
			fi
			case "$opt" in
				"1")
					echo -e "${list}\t${dst}"
					;;
				"")
					echo -e "${list}"
					;;
			esac
			;;
		*) # popd by empty line
			;;
	esac
done

