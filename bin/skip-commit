#!/usr/bin/env bash

rm -- /tmp/skip-commit > /dev/null

SKIP_COMMIT=( \
"147d02c8f9e9e5232c2d970f2c647e09e9ab2370"
"d607e9387c6bf4995c06199e60d947b80ed8b1eb"
"c17a76fe7568118fa59f51599962eb3ea69ef439"
"94365fd822551be9aebc3d8d1397afb35470d2bd"
"81da7f70a69fc172e28cc16a9c69147c573867d4"
"0441eaebc84970a72238e4507575f3b5058ff029"
"540bf5fe074831e8d501b4e7317dbce8b6c1f9f7"
"fbaae1cde811fdf1e9af31dc0a66c8978c810e4e"
"d4fb089307cc03e5d4e2cc39364b0948fde98999"
"b86cbcfb357e683884c0188f353fe5307c62935c"
"655c9237f7a8f5c1fe70a85d382d3be7da0d9591"
"2a8badb831332e567f8aea6cd359cf37f85195b9"
"8b6b6f75ce1e1c7f3dc5828c8046d943638b064c"
"727ea2edd37360d892253c23df4c14c3523250cd"
"b5689c24396263537538e2343ba8b4249738f952"
"7db5577c235b4092557d5c12ca55fbac7f443fbc"
"78565b370b7b1051b019f9df72cc8a5aec90b65c"
"a1b89199a6cfb70dd67afb1e2c072c3b2cb89523"
"51351b73ba8280c01e8f7ac6e0c056c18df96f07"
"84a94a784248bac64933bb5c401ace8f83dca3c0"
"e546b0968cdede6eee7b7b7f1b3339ac4f6f42d5"
"98806d1e6e6f8d2384d88ea2f15123e5e162bdfe"
"faa55620f41a243e51260b3a0427eabb70b2d3ca"
"dd3ac2f5540d533c6760594eac2abf0181acd9e0"
"7ef7253f92b3a4b3b703c85942d8914fb81986f4"
"314cca7788345af815029e7d3032f8df799ea5a1"
"c3c8a59b45e0bcd1d364847d873dc568277b22e9"
"552f0c9f887e8d9d57d8978504b8cd4d4b0bc9ac"
"1795fa3141d7e97ef1ced188cdf29f7f27d1caa4"
"447d3605404fa08ab43bca05f55c98af18cec4ed"
"433427bfc643fe84d4d5ac0a0a40cbe90820e1dd"
"1b494362c8816149c8aef9940fb11e99724b9d70"
"df2370f4527fb5ba9e07475c9554f2fc74182956"
"763ff7e3eb3ef91d3dc276ecb66122ed3b4b2b9a"
"3a08d0fb62d3a3fc3d63452cf2ade5a972c8d599"
"8308a050b8b928cef777cfa9038380623852e942"
"d0d4fec3d1881e37740809f4d27ffb4f0dd503f4"
"20a1245424a5a8fab4ce7b4cbc5929b0e5f22fa2"
"b4099b49bd5d610bf176b403bef3f263d4c2e040"
"f67216ff8affbdf9433e8352f45f1684b6664a9f"
"ebe4d9b1dca140bc2f7bfd2b211f6e44675ec520"
"e76fdbbc98c0d8b2c5d04ae19dc01ee4868bb214"
"7720192bf742f94f9ac4b343330e4e1a1503eb66"
"c6c034506d3f726474de6a7dfeeb05cbaf8c633f"
"293cab84e7544313be93fc1eff0f188ec31fb2f9"
"68785bf46ab0b101219433802ff7bdea31af17fe"
"168a98c5b494e1b7f28f3fd4d1a85b243bfcf164"
"2c9ad9c1cb4ddd710e8f9930c28e5c1a8d436b09"
"25327bb4a632be162bc3ffaed2482f8a69d725d2"
"bdf87b3438766cdc37482ecdaa5a9c491752b412"
"04fb7d2009b0582429f585bc7b156b72993b8959"
"9e0d5fc5bc44d24116044b9c759c10d96b96c941"
"00613723986a620069845e15aabe5231e8f7033d"
"18e599c33a9d85c54572ecd59380c0dc0836c6f5"
"f9e9b29f97aa15a5747a272ab45d2c69da076ab6"
"aad8638739041d6ee567559aee79eea3a6c40471"
"4b8c79e9f79235327d06cfdf36a54e6733287963"
"ce0ce71672745f7f554d16466d5e6b70c2a0bd6f"
"18b22d2705e4ae1d6bedfd51d53328e2ee9b2f3a"
"d76e37421b97d0b279f329dd45caec68e0e21dbc"
"a13609e9bfb8b761938fa8864c613d4afc33fbbd"
"b96452e2b671c474da321cad4a99edf54685c1a9"
"825dab6cf672fcd1d2ef5e44ae55c4dd2eab3074"
"69abe75924bff669c9994e22e428bed8122bfe39"
"df4a2826df740ab1ac39ce0ab352622dd3feb2da"
"8e6403ea2d3d5f1a22010f3102fed8c902086ac9"
"0c06b4425754d147a57e82f5b3fd8c0437153c09"
"71d09d11f47d4b03c3b94966d70828d0f9ae3d1b"
"5a389fbe644f6ac58f7830d9cb238e7b32c9a896"
"380e00ceba31c0b7b8e3d8f3b7880f20817fa648"
"be95ba1941b05aed71bfedc6981a93e5d900863d"
"6a7302a9c30e726ca693c29c98c495761fbf9265"
"553ca87f3edcada2d5d5845718f089fd4244d7f3"
"625a0b468e4fff05aabd41742689999d30742732"
"ac15bb311aada354834623a183df5dd55c432cd6"
"f298b3901d196302bec0e0486a9b8ff63b606ba8"
"766b9cf96b0fc8d618793279b6b737ec4dbdd67f"
"89257a37868d6ee2ea3d48604fc479df3e5f46a6"
"8d7fa221959db4eb5af4acce32c3eff87ec0bffd"
"45876b3b9cceadd74774eb1b8700f67616f64c51"
"cd36a3cc86ed73280be996bc18004be92bbdf392"
"21510ef1d0573c1c387d0f0120bb9aa83c748ebd"
"0b9fe43e9c7bf14b8a3d6562ca3959864bc28bea"
"a6685d11e6056b4c61c5e60cada5d32761550448"
"e8e2811b2aa2615dbedf99735f305ea99172dcdc"
"0f8d1619782ca11c5f4d2d67849b4fb988317067"
"8d21c2f1ca75f83dc5d6b4eb9c2015b7592e6205"
"f542b4b9e6e51426e96db32c22b6c8b23650decc"
"1c995dac9aac5430f7d55876ab0f4cd78fc89c30"
"a5c1d55a33e953b5c4fd0645314defd3805476a3"
"1c44c15bbdb652741b347036052a9b30cbd6a749"
"f575745099570ac473d954c60d5f619449009fb1"
"485acec232ee3d70495aedb86d1f79f49b4cb382"
"e52d93b4b9e8210a7c5d543a903cef73f32ec5e3"
"74767eae2c7c69a3245b2512057aa3d123149e3b"
"f18843a7b28b01e5f4a90c83ab125514ee49649d"
"c07ceb5f6848b9295a150324935b3d3729f5a71d"
"bdb0c3c8db2c93cbb63c47938fcf5ce8b8a6189a"
"5577eeab5c84f79aeb923ded9551d57d970be963"
"224a1301162b65bd5f58fa49ca38e43f844e850d"
"5889ca245fe2a62db9c6660a77d64cd2df7c5a9a"
"a021ec1e05ff34349bc55f79c5b489d33bea136c"
)

GIT_COMMIT="$1"
RET=1

if [ ! "$GIT_COMMIT" ]; then
	echo "$GIT_COMMIT: <commit> missing." >> /tmp/skip-commit
	echo "$RET" >> /tmp/skip-commit
	exit "$RET"
fi

echo "$GIT_COMMIT" >> /tmp/skip-commit

for c in "${SKIP_COMMIT[@]}";
do
	if [ "$GIT_COMMIT" = "$c" ]; then
		echo "$c found" >> /tmp/skip-commit
		RET=0
		echo "$RET" >> /tmp/skip-commit
		exit "$RET"
	fi
done

echo "$GIT_COMMIT not found" >> /tmp/skip-commit
echo "$RET" >> /tmp/skip-commit
exit "$RET"

cat <<EOT
git filter-branch --commit-filter '
                   skip-commit "$GIT_COMMIT"
                   if [ "$?" = "0" ];
                   then
                           skip_commit "$@";
                   else
                           git commit-tree "$@";
                   fi' HEAD
EOT >> /tmp/skip-commit

