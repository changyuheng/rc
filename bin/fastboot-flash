#!/usr/bin/env bash
# Author: Andrew Chen <yongjhih@gmail.com>
# CC, Creative Commons
# Author: Andrew Chen <yongjhih@gmail.com>
# CC, Creative Commons
#for i in userdata.img boot.img; do fastboot flash "${i%.*}" "$i"; done

if [ ! "$1" ]; then
	cat <<EOF
$0 <image.img ...>
EOF

	exit 1
fi

RET=
while [ "$1" ]; do
	FILEPATH="${1##*/}"
	FILENAME="${FILEPATH%.img}"
	#for i in userdata.img boot.img; do fastboot flash "${i%.*}" "$i"; done
	if [ "${1%.img}" = "$1" ]; then
		echo "$1 is not *.img, skip."
		RET="1"
	else
		fastboot flash "$FILENAME" "$1"
		RET="$?"
	fi

	shift
done

[ $RET = "0" ] && fastboot reboot

